### 测试测量应用程序设计

#### 普通循环模型

一个简单的测试程序的过程可以简化为数据的采集、处理、显示、保存。在这个模型中，各个程序模块是单线程顺序执行的。它的优点是程序逻辑简单，容易设计和理解。

但是，此模型中，每个功能模块之间存在着顺序上的依赖关系。它只能单线程运行，计算机必须先执行完前一个模块，然后再运行下一个模块。

#### 管道流水线模型

改进效率的方法之一是同时运行这几个功能，当然，对于单个的数据来说，还是需要先采集，之后再显示和保存。所以，同时运行这几个功能并不是对同一个数据同时运行这几个功能。而是程序在采集新数据的同时，处理上一次循环迭代采集到的数据，同时，显示和存储上一次循环迭代处理好的数据。这有点类似于一个需要多道工序产品的生产作业流水线。

在流水线模型中，程序执行一次循环迭代的时间，即每处理一个数据的时间取决于采集、处理、显示和存储这几个步骤中好使最长的那一个。如果程序中总是同一个步骤耗时最长，那么使用流水线模型是个非常好的选择。

流水线的速度总是取决于各工序中最慢的那个，如果能使用一个缓存，在采集数据达到较快、处理速度较慢的时候，把数据先存下来，等数据采集速度减慢或处理速度变快时再对缓存中的数据进行处理，程序的总体效率就可以进一步提高。

#### “生产者——消费者”模型

对采集到的数据做一个缓存，这里采用队列作为缓存，也可以使用其他方式如数组作为数据缓存。新采集到的数据直接放到队列中，这一简单过程耗时极少。也就是说，数据采集多快，就可以以多快的速度存放数据到缓存。程序的另一部分则不断地从队列中取数据，对其进行处理。如果需要，还可以把这个模型中的数据显示和保存部分也放到另一单独的循环中取运行。



#### 数据采样时钟的设置

- 在运行非实时操作系统（如windows）的计算机上，延时函数可以支持的最低值也只有1ms，采样间隔低于1ms就无法使用这种方法了。
- 使用延时的方法精度比较低。比如把延时设置为1ms时，误差极大，可能高达1ms的几十倍。而一般数据采集对于采样间隔时间的精度要求都是比较高的。再有，每采集一个数据就重新读一次数据采集设备，在如此高的数据两下，是一种效率非常地下的做法。
